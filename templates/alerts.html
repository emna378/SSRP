<!DOCTYPE html>
<html>
<head>
    <title>Alertes de SÃ©curitÃ©</title>
</head>
<body>

<h2 style="color:red;">ðŸš¨ Alertes de SÃ©curitÃ©</h2>

<table border="1" width="100%">
    <tr style="background:#eee;">
        <th>IP Attaquant</th>
        <th>Hostname</th>
        <th>Type dâ€™alerte</th>
        <th>PID</th>
        <th>DerniÃ¨re dÃ©tection</th>
        <th>Actions</th>
    </tr>

    {% for alert in alerts %}
    <tr>
        <td>{{ alert.ip }}</td>
        <td>{{ alert.hostname }}</td>
        <td style="color:red; font-weight:bold;">{{ alert.type }}</td>
        <td>{{ alert.pid if alert.pid else "N/A" }}</td>
        <td>{{ alert.timestamp }}</td>
        <td>
            <!-- Block IP -->
            <a href="{{ url_for('block_ip', ip=alert.ip) }}">
                <button style="background:red; color:white;">
                    ðŸ”’ Block IP
                </button>
            </a>

            <!-- Kill Process -->
            {% if alert.pid %}
            <a href="{{ url_for('kill_process', ip=alert.ip, pid=alert.pid) }}">
                <button style="background:black; color:white;">
                    ðŸ›‘ Kill Process
                </button>
            </a>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

<br>
<a href="{{ url_for('dashboard') }}">
    <button>â¬… Retour Dashboard</button>
</a>

</body>
</html>

